<!DOCTYPE html>
<html lang="en">
<head>
  <!-- PWA manifest and icons -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#004aad">
  <link rel="apple-touch-icon" href="Appicon.png">
  <link rel="icon" type="image/png" href="Appicon.png">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lotto Results Bukidnon</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
      background: #f50000;
    }

    header {
      background: #004aad;
      color: white;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    header img {
      width: 50px;
      height: 50px;
    }

    h1 {
      margin: 0;
      font-size: 1.5rem;
    }

    .container {
      max-width: 600px;
      margin: 20px auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    h2 {
      color: #004aad;
    }

    .results {
      text-align: left;
      margin: 15px 0;
      font-weight: bold;
    }

    .result-item {
      background: #f1f1f1;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .result-item strong {
      color: #000;
    }

    .generator {
      margin-top: 20px;
    }

    .number-box {
      font-size: 2rem;
      font-weight: bold;
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 15px 0;
    }

    .digit {
      width: 50px;
      height: 50px;
      background: #004aad;
      color: white;
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }

    button {
      padding: 10px 20px;
      font-size: 1rem;
      background: #ff4d6d;
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background: #d93654;
    }

    .note {
      margin-top: 15px;
      font-size: 0.9rem;
      color: #444;
      text-align: justify;
    }

    /* ‚úÖ Loading screen */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url("loading-bg.jpg") no-repeat center center;
      background-size: cover;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .spinner {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #004aad;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
    }

    .loading-dev {
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
      position: absolute;
      bottom: 20px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
    }

    .fade-out {
      opacity: 0;
      transition: opacity 1s ease;
    }
    
    .combination-container {
      display: flex;
      justify-content: center;
      margin-bottom: 8px;
    }

    .number-grid-2 {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 1px;
      background-color: white;
      width: fit-content;
    }

    .number-cell {
      background-color: white;
      border: 1.5px solid black;
      text-align: center;
      padding: 8px;
    }

    .number-cell .big {
      font-size: 18px;
      display: block;
      padding-bottom: 4px;
      border-bottom: 1px solid black;
      margin-bottom: 4px;
    }

    .number-cell .small {
      font-size: 16px;
      display: block;
      margin-top: 4px;
      font-weight: bold;
    }
    /* Padikit Number Grid Style */
    .number-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 1px;
      background-color: black;
      margin: 3px 0;
      border: 1.5px solid black;
    }

    .number-grid div {
      background-color: white;
      color: black;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      border: 1px solid black;
    }

    .grid-title {
      text-align: center;
      font-size: 15px;
      font-weight: bold;
      color: #0d47a1;
      margin-top: 10px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <!-- ‚úÖ Loading Screen -->
  <div id="loading-screen">
    <div class="spinner"></div>
    <div class="loading-text">Loading Lotto Results...</div>
    <div class="loading-dev">By Reven</div>
  </div>

  <header>
    <img src="pcsologo.png" alt="PCSO Logo">
    <h1>PCSO Lotto Results</h1>
  </header>

  <div class="container">
    <div class="date-picker">
      <label for="date">üóìÔ∏è Select Date:</label>
      <input type="date" id="date" />
    </div>

    <h2>STL Bukidnon Results</h2>
    <div class="results" id="stl-results">
      <div class="result-item" id="stl-1030"><strong>10:30 AM</strong> ‚Üí Pending...</div>
      <div class="result-item" id="stl-3pm"><strong>3:00 PM</strong> ‚Üí Pending...</div>
      <div class="result-item" id="stl-8pm"><strong>8:00 PM</strong> ‚Üí Pending...</div>
    </div>

    <h2>3D National Results</h2>
    <div class="results" id="3d-results">
      <div class="result-item" id="3d-2pm"><strong>2:00 PM</strong> ‚Üí Pending...</div>
      <div class="result-item" id="3d-5pm"><strong>5:00 PM</strong> ‚Üí Pending...</div>
      <div class="result-item" id="3d-9pm"><strong>9:00 PM</strong> ‚Üí Pending...</div>
    </div>
    
    <div class="combination-container">
      <div class="number-grid-2">
        <div class="number-cell"><span class="big">1</span><span class="small">270</span></div>
        <div class="number-cell"><span class="big">2</span><span class="small">681</span></div>
        <div class="number-cell"><span class="big">3</span><span class="small">683</span></div>
        <div class="number-cell"><span class="big">4</span><span class="small">075</span></div>
        <div class="number-cell"><span class="big">5</span><span class="small">298</span></div>
        <div class="number-cell"><span class="big">6</span><span class="small">316</span></div>
        <div class="number-cell"><span class="big">7</span><span class="small">392</span></div>
        <div class="number-cell"><span class="big">8</span><span class="small">328</span></div>
        <div class="number-cell"><span class="big">9</span><span class="small">954</span></div>
        <div class="number-cell"><span class="big">10</span><span class="small">102</span></div>
        <div class="number-cell"><span class="big">11</span><span class="small">976</span></div>
        <div class="number-cell"><span class="big">12</span><span class="small">435</span></div>
        <div class="number-cell"><span class="big">13</span><span class="small">812</span></div>
        <div class="number-cell"><span class="big">14</span><span class="small">512</span></div>
        <div class="number-cell"><span class="big">15</span><span class="small">564</span></div>
        <div class="number-cell"><span class="big">16</span><span class="small">914</span></div>
        <div class="number-cell"><span class="big">17</span><span class="small">258</span></div>
        <div class="number-cell"><span class="big">18</span><span class="small">810</span></div>
        <div class="number-cell"><span class="big">19</span><span class="small">419</span></div>
        <div class="number-cell"><span class="big">20</span><span class="small">432</span></div>
        <div class="number-cell"><span class="big">21</span><span class="small">816</span></div>
        <div class="number-cell"><span class="big">22</span><span class="small">319</span></div>
        <div class="number-cell"><span class="big">23</span><span class="small">564</span></div>
        <div class="number-cell"><span class="big">24</span><span class="small">914</span></div>
        <div class="number-cell"><span class="big">25</span><span class="small">530</span></div>
        <div class="number-cell"><span class="big">26</span><span class="small">508</span></div>
        <div class="number-cell"><span class="big">27</span><span class="small">579</span></div>
        <div class="number-cell"><span class="big">28</span><span class="small">674</span></div>
        <div class="number-cell"><span class="big">29</span><span class="small">452</span></div>
        <div class="number-cell"><span class="big">30</span><span class="small">849</span></div>
        <div class="number-cell"><span class="big">31</span><span class="small">716</span></div>
      </div>
    </div>

    <!-- Padikit Grid -->
    <h2 class="grid-title">DIRI TA SA UBOS PADIKIT</h2>
    <div class="number-grid">
      <div>4</div><div>7</div><div>2</div><div>6</div><div>2</div><div>1</div><div>9</div><div>0</div>
      <div>6</div><div>1</div><div>5</div><div>0</div><div>4</div><div>3</div><div>7</div><div>1</div>
      <div>9</div><div>3</div><div>2</div><div>1</div><div>8</div><div>2</div><div>4</div><div>8</div>
      <div>8</div><div>9</div><div>5</div><div>4</div><div>3</div><div>0</div><div>5</div><div>0</div>
      <div>4</div><div>6</div><div>7</div><div>8</div><div>6</div><div>3</div><div>9</div><div>3</div>
      <div>9</div><div>3</div><div>2</div><div>0</div><div>1</div><div>7</div><div>8</div><div>7</div>
      <div>1</div><div>6</div><div>7</div><div>9</div><div>4</div><div>9</div><div>2</div><div>4</div>
      <div>2</div><div>0</div><div>5</div><div>1</div><div>6</div><div>5</div><div>6</div><div>5</div>
      <div>0</div><div>3</div><div>4</div><div>8</div><div>2</div><div>5</div><div>3</div><div>9</div>
    </div>
    
    <div class="generator">
      <h2>üé∞ Lucky 3 Digit Generator</h2>
      <div class="number-box">
        <div class="digit" id="digit1">-</div>
        <div class="digit" id="digit2">-</div>
        <div class="digit" id="digit3">-</div>
      </div>
      <button onclick="generateLuckyNumbers()">Generate</button>

      <p class="note">
        Note: <i>The numbers generated here are purely random and are not official results from the PCSO or any of its agencies. 
        This feature is for entertainment purposes only and does not guarantee any winning combinations.</i>
      </p>
    </div>
  </div>

  <script>
    const JSON_URL = "https://curlybracer.github.io/3D-STL-Results/results.json";

    // ‚è≥ Start timer for loading screen
    window.loadingStartTime = Date.now();

    // ‚úÖ Auto-set today's date
    const dateInput = document.getElementById("date");
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    dateInput.value = `${yyyy}-${mm}-${dd}`;

    // ‚úÖ Lucky 3 Generator with Rolling Effect
    function generateLuckyNumbers() {
      const digits = [digit1, digit2, digit3];
      digits.forEach((digit, index) => {
        let count = 0;
        const interval = setInterval(() => {
          digit.textContent = Math.floor(Math.random() * 10);
          count++;
          if (count > 15 + index * 5) {
            clearInterval(interval);
            digit.textContent = Math.floor(Math.random() * 10);
          }
        }, 100);
      });
    }

    // ‚úÖ Fetch results from grouped JSON
    async function fetchResults(date) {
      try {
        const response = await fetch(`${JSON_URL}?t=${new Date().getTime()}`);
        const data = await response.json();

        const resultsMap = {
          "stl-1030": "<strong>10:30 AM</strong> ‚Üí Pending...",
          "stl-3pm": "<strong>3:00 PM</strong> ‚Üí Pending...",
          "stl-8pm": "<strong>8:00 PM</strong> ‚Üí Pending...",
          "3d-2pm": "<strong>2:00 PM</strong> ‚Üí Pending...",
          "3d-5pm": "<strong>5:00 PM</strong> ‚Üí Pending...",
          "3d-9pm": "<strong>9:00 PM</strong> ‚Üí Pending..."
        };

        if (data[date]) {
          const stl = data[date]["STL"] || {};
          const threeD = data[date]["3D"] || {};

          if (stl["10:30 AM"]) resultsMap["stl-1030"] = `<strong>10:30 AM</strong> ‚Üí ${stl["10:30 AM"]}`;
          if (stl["3:00 PM"]) resultsMap["stl-3pm"] = `<strong>3:00 PM</strong> ‚Üí ${stl["3:00 PM"]}`;
          if (stl["8:00 PM"]) resultsMap["stl-8pm"] = `<strong>8:00 PM</strong> ‚Üí ${stl["8:00 PM"]}`;

          if (threeD["2:00 PM"]) resultsMap["3d-2pm"] = `<strong>2:00 PM</strong> ‚Üí ${threeD["2:00 PM"]}`;
          if (threeD["5:00 PM"]) resultsMap["3d-5pm"] = `<strong>5:00 PM</strong> ‚Üí ${threeD["5:00 PM"]}`;
          if (threeD["9:00 PM"]) resultsMap["3d-9pm"] = `<strong>9:00 PM</strong> ‚Üí ${threeD["9:00 PM"]}`;
        }

        Object.keys(resultsMap).forEach(id => {
          document.getElementById(id).innerHTML = resultsMap[id];
        });

      } catch (err) {
        console.error("Error fetching results:", err);
      } finally {
        const loadingScreen = document.getElementById("loading-screen");
        const minLoadingTime = 10000; // 10 seconds
        const startTime = window.loadingStartTime || Date.now();
        const elapsed = Date.now() - startTime;
        const remaining = Math.max(0, minLoadingTime - elapsed);

        setTimeout(() => {
          loadingScreen.classList.add("fade-out");
          setTimeout(() => {
            loadingScreen.style.display = "none";
          }, 1000);
        }, remaining);
      }
    }

    // ‚úÖ Initial load
    fetchResults(dateInput.value);

    // ‚úÖ Change when date selected
    dateInput.addEventListener("change", function() {
      fetchResults(this.value);
    });

    // ‚úÖ Register service worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service Worker registered"))
        .catch(err => console.error("SW registration failed:", err));
    }
  </script>
</body>
  </html>
